var __vite_style__=document.createElement("style");__vite_style__.innerHTML=`.icon-button{border:none;border-radius:50%;cursor:pointer;fill:currentColor;display:flex;align-items:center;justify-content:center}.icon-button svg{height:1.5em;width:1.5em}.icon-remove{color:var(--danger-color, #d13438)}.player-line-control{position:relative;height:4px;border-radius:4px;background-color:#ddd;transition:all .1s ease-in}.player-line-control:hover{height:8px}.player-line-control__head{position:absolute;height:inherit;background-color:var(--primary-color, #0f6cbd);border-radius:inherit}.player-volume{display:flex;align-items:center;line-height:10px}.player-volume-bar{width:50px;border-radius:4px;position:relative;width:0;overflow:hidden}.player-volume__icon{width:24px;height:24px;border:0;border-radius:0;padding:0;background-color:unset;margin-right:3px}.player-volume:hover .player-volume-bar{width:50px}.recorder-player{margin:.5em 0;width:100%;max-width:400px;display:flex;align-items:center;justify-content:center}.vue-player{width:100%;height:unset;border:0;display:flex;flex-direction:row;align-items:center;justify-content:center;background-color:unset;border:1px solid var(--border-color, #eee);border-radius:10em;padding:.5em;box-sizing:border-box;margin-top:.75em}.vue-player>.vue-player-bar{margin:0 0 0 5px}.vue-player>.vue-player-bar>.vue-player__progress{width:100%}.vue-player-bar{display:flex;align-items:center;height:32px;flex:1}.vue-player-actions{width:55%;display:flex;align-items:center;justify-content:space-around;flex:0}.vue-player__progress{margin:0 .9em}.vue-player__time{white-space:nowrap;color:var(--text-color, #333);font-size:.8em;width:80px}.vue-player__play{width:32px;height:32px;background-color:transparent}.disabled{opacity:.5;pointer-events:none;cursor:not-allowed;user-select:none}figure{margin:0}.recorder-container{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:.75em;margin:.75em}.recorder-action{display:flex;align-items:center;justify-content:center}.recorder-action .vue-recorder-action{width:48px;height:48px;border:1px solid var(--primary-color, #0f6cbd);font-size:18px}.recorder-action .vue-recorder-stop{width:32px;height:32px;margin-left:4px;border:1px solid var(--primary-color, #0f6cbd);font-size:12px}.recorder-message>span{display:block;padding:.5em;border-radius:1em;margin:.5em 0}.recorder-message>span.color-primary{background-color:#b4d6fa}.recorder-message>span.color-success{background-color:#9fd89f}.recorder-message>span.color-danger{background-color:#f4bfab}.vue-records{display:flex;flex-direction:column;width:100%;align-items:center;margin-top:.75em}.vue-records .list-actions{display:flex}.vue-records .list-actions>.icon-button{width:24px;height:24px}.vue-records__record{display:flex;width:100%;max-width:400px;justify-content:space-between;padding:.5em;border-radius:2em}.vue-records__record--selected{border:1px solid rgba(100,100,100,.2)}.vue-records__record .icon-button{background-color:transparent}.timing{display:flex;flex-direction:column;align-items:center;justify-content:center}.timing .time-limit,.timing .time-attempt{font-size:.75em}.timing .recorder-timer{margin:0 .25em}.timing .recording-time{text-transform:capitalize}
(function(d,u){typeof exports=="object"&&typeof module!="undefined"?u(exports):typeof define=="function"&&define.amd?define(["exports"],u):(d=typeof globalThis!="undefined"?globalThis:d||self,u(d["vuejs2-audio-recorder"]={}))})(this,function(d){"use strict";`;document.head.appendChild(__vite_style__);class u{constructor(s){this.backendEndpoint=s}async postBackend(s){try{return!!(await fetch(this.backendEndpoint,{method:"POST",body:s})).ok}catch{return!1}}}function n(e){return e?new Date(e*1e3).toISOString().substring(14,19):"00:00"}class S{constructor(s){this.bufferSize=s.bufferSize||4096,this.sampleRate=s.sampleRate,this.samples=s.samples}finish(){this._joinSamples();const s=new ArrayBuffer(44+this.samples.length*2),t=new DataView(s);this._writeString(t,0,"RIFF"),t.setUint32(4,36+this.samples.length*2,!0),this._writeString(t,8,"WAVE"),this._writeString(t,12,"fmt "),t.setUint32(16,16,!0),t.setUint16(20,1,!0),t.setUint16(22,1,!0),t.setUint32(24,this.sampleRate,!0),t.setUint32(28,this.sampleRate*4,!0),t.setUint16(32,4,!0),t.setUint16(34,16,!0),this._writeString(t,36,"data"),t.setUint32(40,this.samples.length*2,!0),this._floatTo16BitPCM(t,44,this.samples);const r=new Blob([t],{type:"audio/wav"});return{id:Date.now(),blob:r,url:URL.createObjectURL(r)}}_floatTo16BitPCM(s,t,r){for(let i=0;i<r.length;i++,t+=2){const o=Math.max(-1,Math.min(1,r[i]));s.setInt16(t,o<0?o*32768:o*32767,!0)}}_joinSamples(){const s=this.samples.length*this.bufferSize,t=new Float64Array(s);let r=0;for(let i=0;i<this.samples.length;i++){const o=this.samples[i];t.set(o,r),r+=o.length}this.samples=t}_writeString(s,t,r){for(let i=0;i<r.length;i++)s.setUint8(t+i,r.charCodeAt(i))}}class ${constructor(s={}){this.beforeRecording=s.beforeRecording,this.pauseRecording=s.pauseRecording,this.afterRecording=s.afterRecording,this.micFailed=s.micFailed,this.encoderOptions={bitRate:s.bitRate,sampleRate:s.sampleRate},this.bufferSize=4096,this.records=[],this.isPause=!1,this.isRecording=!1,this.duration=0,this.volume=0,this.wavSamples=[],this._duration=0}start(){const s={video:!1,audio:{channelCount:1,echoCancellation:!1}};this.beforeRecording&&this.beforeRecording("start recording"),navigator.mediaDevices.getUserMedia(s).then(this._micCaptured.bind(this)).catch(this._micError.bind(this)),this.isPause=!1,this.isRecording=!0}stop(){this.stream.getTracks().forEach(r=>r.stop()),this.input.disconnect(),this.processor.disconnect(),this.context.close();let s=null;s=new S({bufferSize:this.bufferSize,sampleRate:this.encoderOptions.sampleRate,samples:this.wavSamples}).finish(),this.wavSamples=[],s.duration=n(this.duration),this.records.push(s),this._duration=0,this.duration=0,this.isPause=!1,this.isRecording=!1,this.afterRecording&&this.afterRecording(s)}pause(){this.stream.getTracks().forEach(s=>s.stop()),this.input.disconnect(),this.processor.disconnect(),this._duration=this.duration,this.isPause=!0,this.pauseRecording&&this.pauseRecording("pause recording")}recordList(){return this.records}lastRecord(){return this.records.slice(-1).pop()}_micCaptured(s){this.context=new(window.AudioContext||window.webkitAudioContext),this.duration=this._duration,this.input=this.context.createMediaStreamSource(s),this.processor=this.context.createScriptProcessor(this.bufferSize,1,1),this.stream=s,this.processor.onaudioprocess=t=>{const r=t.inputBuffer.getChannelData(0);let i=0;this.wavSamples.push(new Float32Array(r));for(let o=0;o<r.length;++o)i+=r[o]*r[o];this.duration=parseFloat(this._duration)+parseFloat(this.context.currentTime.toFixed(2)),this.volume=Math.sqrt(i/r.length).toFixed(2)},this.input.connect(this.processor),this.processor.connect(this.context.destination)}_micError(s){this.micFailed&&this.micFailed(s)}}var B=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("button",{staticClass:"icon-button",class:"icon-"+e.name,attrs:{type:"button"},on:{click:function(r){return e.onClick()}}},[t("span",{domProps:{innerHTML:e._s(e.icons[e.name])}})])},L=[],ne="";function h(e,s,t,r,i,o,R,ie){var a=typeof e=="function"?e.options:e;s&&(a.render=s,a.staticRenderFns=t,a._compiled=!0),r&&(a.functional=!0),o&&(a._scopeId="data-v-"+o);var c;if(R?(c=function(l){l=l||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!l&&typeof __VUE_SSR_CONTEXT__!="undefined"&&(l=__VUE_SSR_CONTEXT__),i&&i.call(this,l),l&&l._registeredComponents&&l._registeredComponents.add(R)},a._ssrRegister=c):i&&(c=ie?function(){i.call(this,(a.functional?this.parent:this).$root.$options.shadowRoot)}:i),c)if(a.functional){a._injectStyles=c;var oe=a.render;a.render=function(ae,M){return c.call(M),oe(ae,M)}}else{var C=a.beforeCreate;a.beforeCreate=C?[].concat(C,c):[c]}return{exports:e,options:a}}const k={props:{name:{type:String}},data(){return{icons:{download:'<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 16 16"><path fill="currentColor" d="M3.5 13h9a.5.5 0 0 1 .09.992L12.5 14h-9a.5.5 0 0 1-.09-.992L3.5 13h9h-9ZM7.91 1.008L8 1a.5.5 0 0 1 .492.41l.008.09v8.792l2.682-2.681a.5.5 0 0 1 .638-.058l.07.058a.5.5 0 0 1 .057.638l-.058.069l-3.535 3.536a.5.5 0 0 1-.638.057l-.07-.057l-3.535-3.536a.5.5 0 0 1 .638-.765l.069.058L7.5 10.292V1.5a.5.5 0 0 1 .41-.492L8 1l-.09.008Z"/></svg>',upload:'<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 16 16"><path fill="currentColor" d="M3.5 2a.5.5 0 0 0 0 1h9a.5.5 0 0 0 0-1h-9Zm4.854 2.146a.5.5 0 0 0-.708 0l-3.5 3.5a.5.5 0 1 0 .708.708L7.5 5.707V13.5a.5.5 0 0 0 1 0V5.707l2.646 2.647a.5.5 0 0 0 .708-.708l-3.5-3.5Z"/></svg>',mic:'<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 16 16"><path fill="currentColor" d="M5.5 4.5a2.5 2.5 0 0 1 5 0V8a2.5 2.5 0 0 1-5 0V4.5ZM8 3a1.5 1.5 0 0 0-1.5 1.5V8a1.5 1.5 0 1 0 3 0V4.5A1.5 1.5 0 0 0 8 3ZM4 7.5a.5.5 0 0 1 .5.5a3.5 3.5 0 1 0 7 0a.5.5 0 0 1 1 0a4.5 4.5 0 0 1-4 4.473V13.5a.5.5 0 0 1-1 0v-1.027A4.5 4.5 0 0 1 3.5 8a.5.5 0 0 1 .5-.5Z"/></svg>',pause:'<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 16 16"><path fill="currentColor" d="M3.75 2A1.75 1.75 0 0 0 2 3.75v8.5c0 .966.784 1.75 1.75 1.75h1.5A1.75 1.75 0 0 0 7 12.25v-8.5A1.75 1.75 0 0 0 5.25 2h-1.5ZM3 3.75A.75.75 0 0 1 3.75 3h1.5a.75.75 0 0 1 .75.75v8.5a.75.75 0 0 1-.75.75h-1.5a.75.75 0 0 1-.75-.75v-8.5ZM10.75 2A1.75 1.75 0 0 0 9 3.75v8.5c0 .966.784 1.75 1.75 1.75h1.5A1.75 1.75 0 0 0 14 12.25v-8.5A1.75 1.75 0 0 0 12.25 2h-1.5ZM10 3.75a.75.75 0 0 1 .75-.75h1.5a.75.75 0 0 1 .75.75v8.5a.75.75 0 0 1-.75.75h-1.5a.75.75 0 0 1-.75-.75v-8.5Z"/></svg>',play:'<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 16 16"><path fill="currentColor" d="M5.745 3.064A.5.5 0 0 0 5 3.5v9a.5.5 0 0 0 .745.436l8-4.5a.5.5 0 0 0 0-.871l-8-4.5ZM4 3.5a1.5 1.5 0 0 1 2.235-1.307l8 4.5a1.5 1.5 0 0 1 0 2.615l-8 4.5A1.5 1.5 0 0 1 4 12.5v-9Z"/></svg>',save:'<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 16 16"><path fill="currentColor" d="M4 3a1 1 0 0 0-1 1v8a1 1 0 0 0 1 1V9.5A1.5 1.5 0 0 1 5.5 8h5A1.5 1.5 0 0 1 12 9.5V13a1 1 0 0 0 1-1V5.621a1 1 0 0 0-.293-.707l-1.621-1.621A1 1 0 0 0 10.379 3H10v1.5A1.5 1.5 0 0 1 8.5 6h-2A1.5 1.5 0 0 1 5 4.5V3H4Zm2 0v1.5a.5.5 0 0 0 .5.5h2a.5.5 0 0 0 .5-.5V3H6Zm5 10V9.5a.5.5 0 0 0-.5-.5h-5a.5.5 0 0 0-.5.5V13h6ZM2 4a2 2 0 0 1 2-2h6.379a2 2 0 0 1 1.414.586l1.621 1.621A2 2 0 0 1 14 5.621V12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V4Z"/></svg>',stop:'<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 16 16"><path fill="currentColor" d="M12.5 3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5v-9a.5.5 0 0 1 .5-.5h9Zm-9-1A1.5 1.5 0 0 0 2 3.5v9A1.5 1.5 0 0 0 3.5 14h9a1.5 1.5 0 0 0 1.5-1.5v-9A1.5 1.5 0 0 0 12.5 2h-9Z"/></svg>',volume:'<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 16 16"><path d="M8.694 2.04A.5.5 0 0 1 9 2.5v11a.5.5 0 0 1-.85.357l-2.927-2.875H3.5a1.5 1.5 0 0 1-1.5-1.5v-2.99a1.5 1.5 0 0 1 1.5-1.5h1.724l2.927-2.85a.5.5 0 0 1 .543-.103zm3.043 1.02l.087.058l.098.085c.063.056.15.138.252.245c.206.213.476.527.746.938a6.542 6.542 0 0 1 1.083 3.618a6.522 6.522 0 0 1-1.083 3.614c-.27.41-.541.724-.746.936l-.142.141l-.187.17l-.033.026a.5.5 0 0 1-.688-.72l.13-.117a5.49 5.49 0 0 0 .83-.985c.46-.7.919-1.73.919-3.065a5.542 5.542 0 0 0-.919-3.069a5.588 5.588 0 0 0-.54-.698l-.17-.176l-.184-.17a.5.5 0 0 1 .547-.832zM8 3.684L5.776 5.851a.5.5 0 0 1-.349.142H3.5a.5.5 0 0 0-.5.5v2.989a.5.5 0 0 0 .5.5h1.927a.5.5 0 0 1 .35.143L8 12.308V3.685zm2.738 1.374l.1.07l.133.126l.054.056c.114.123.26.302.405.54c.292.48.574 1.193.574 2.148c0 .954-.282 1.668-.573 2.148a3.388 3.388 0 0 1-.405.541l-.102.105l-.07.065l-.04.033l-.063.03c-.133.052-.442.139-.64-.108a.5.5 0 0 1 .012-.638l.134-.129l.034-.036c.075-.08.179-.208.284-.382c.21-.345.429-.882.429-1.63c0-.747-.219-1.283-.428-1.627a2.467 2.467 0 0 0-.223-.311l-.095-.105l-.069-.065a.5.5 0 0 1 .55-.83z" fill="currentColor" fill-rule="nonzero"/></svg>',volumeMute:'<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 16 16"><path fill="currentColor" d="M8.694 2.04A.5.5 0 0 1 9 2.5v11a.5.5 0 0 1-.85.357l-2.927-2.875H3.5a1.5 1.5 0 0 1-1.5-1.5v-2.99a1.5 1.5 0 0 1 1.5-1.5h1.724l2.927-2.85a.5.5 0 0 1 .543-.103ZM8 3.684L5.777 5.851a.5.5 0 0 1-.35.142H3.5a.5.5 0 0 0-.5.5v2.989a.5.5 0 0 0 .5.5h1.928a.5.5 0 0 1 .35.143L8 12.308V3.685Zm2.147 2.461a.5.5 0 0 1 .707 0l1.147 1.147l1.146-1.147a.5.5 0 1 1 .707.708L12.708 8l1.146 1.146a.5.5 0 1 1-.707.708L12 8.707l-1.147 1.147a.5.5 0 0 1-.707-.708L11.293 8l-1.146-1.146a.5.5 0 0 1 0-.708Z"/></svg>',record:'<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 16 16"><path fill="currentColor" d="M8 12a4 4 0 1 0 0-8a4 4 0 0 0 0 8ZM8 1a7 7 0 1 0 0 14A7 7 0 0 0 8 1ZM2 8a6 6 0 1 1 12 0A6 6 0 0 1 2 8Z"/></svg>',remove:'<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 16 16"><path fill="currentColor" d="M7 3h2a1 1 0 0 0-2 0ZM6 3a2 2 0 1 1 4 0h4a.5.5 0 0 1 0 1h-.564l-1.205 8.838A2.5 2.5 0 0 1 9.754 15H6.246a2.5 2.5 0 0 1-2.477-2.162L2.564 4H2a.5.5 0 0 1 0-1h4Zm1 3.5a.5.5 0 0 0-1 0v5a.5.5 0 0 0 1 0v-5ZM9.5 6a.5.5 0 0 1 .5.5v5a.5.5 0 0 1-1 0v-5a.5.5 0 0 1 .5-.5Zm-4.74 6.703A1.5 1.5 0 0 0 6.246 14h3.508a1.5 1.5 0 0 0 1.487-1.297L12.427 4H3.573l1.187 8.703Z"/></svg>'}}},methods:{onClick(){this.$emit("click")}}},v={};var E=h(k,B,L,!1,P,null,null,null);function P(e){for(let s in v)this[s]=v[s]}var p=function(){return E.exports}();function m(e,s){const t=s.getBoundingClientRect().width,r=e.target.getBoundingClientRect().left;let i=(e.clientX-r)/t;try{if(!e.target.className.match(/^ar\-line\-control/))return}catch{return}return i=i<0?0:i,i=i>1?1:i,i}var A=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{ref:e.refId,staticClass:"player-line-control",on:{mousedown:e.onMouseDown}},[t("div",{staticClass:"player-line-control__head",style:e.calculateSize})])},T=[],le="";const U={props:{refId:{type:String},eventName:{type:String},percentage:{type:Number,default:0},rowDirection:{type:Boolean,default:!0}},computed:{calculateSize(){const e=this.percentage<1?this.percentage*100:this.percentage;return`${this.rowDirection?"width":"height"}: ${e}%`}},methods:{onMouseDown(e){const s=m(e,this.$refs[this.refId]);this.$emit("change-linehead",s),document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp)},onMouseUp(e){document.removeEventListener("mouseup",this.onMouseUp),document.removeEventListener("mousemove",this.onMouseMove);const s=m(e,this.$refs[this.refId]);this.$emit("change-linehead",s)},onMouseMove(e){if(e.buttons==0)return;const s=m(e,this.$refs[this.refId]);this.$emit("change-linehead",s)}}},g={};var Z=h(U,A,T,!1,F,null,null,null);function F(e){for(let s in g)this[s]=g[s]}var f=function(){return Z.exports}(),V=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"player-volume"},[t("icon-button",{staticClass:"player-volume__icon",attrs:{name:"volume"}}),t("line-control",{staticClass:"player-volume-bar",attrs:{"ref-id":"volume",percentage:e.volume},on:{"change-linehead":e.onChangeLinehead}})],1)},z=[],ce="";const j={data(){return{volume:100}},components:{IconButton:p,LineControl:f},methods:{onChangeLinehead(e){this.$emit("change-volume",e),this.volume=e}}},_={};var I=h(j,V,z,!1,H,null,null,null);function H(e){for(let s in _)this[s]=_[s]}var D=function(){return I.exports}(),W=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"recorder-player"},[e.custom?t("div",{staticClass:"vue-player"},[t("div",{staticClass:"vue-player-actions"},[t("icon-button",{staticClass:"ar-icon ar-icon__lg vue-player__play",class:{"vue-player__play--active":e.isPlaying,disabled:e.disablePlayButton},attrs:{id:"play",name:e.playBtnIcon},on:{click:e.playback}})],1),t("div",{staticClass:"vue-player-bar"},[t("div",{staticClass:"vue-player__time"},[e._v(e._s(e.playedTime)+" / "+e._s(e.duration))]),t("line-control",{staticClass:"vue-player__progress",attrs:{"ref-id":"progress",percentage:e.progress},on:{"change-linehead":e._onUpdateProgress}}),t("volume-control",{class:{disabled:e.disablePlayButton},on:{"change-volume":e._onChangeVolume}})],1)]):e._e(),t("figure",{directives:[{name:"show",rawName:"v-show",value:!e.custom,expression:"!custom"}]},[t("audio",{ref:"playerRef",staticClass:"mx-auto",attrs:{controls:"",src:e.audioSource,type:"audio/mpeg"}},[e._v(" Your browser does not support the "),t("code",[e._v("audio")]),e._v(" element. ")])])])},N=[],de="";const O={name:"PlayerWidget",components:{IconButton:p,LineControl:f,VolumeControl:D},props:{record:{type:Object},filename:{type:String},custom:{type:Boolean,default:!1}},data(){return{isPlaying:!1,duration:n(0),playedTime:n(0),progress:0}},mounted(){this.player=this.$refs.playerRef,this.player.addEventListener("ended",()=>{this.isPlaying=!1}),this.player.addEventListener("loadeddata",e=>{this._resetProgress(),this.duration=n(this.player.duration)}),this.player.addEventListener("timeupdate",this._onTimeUpdate)},computed:{disablePlayButton(){return!this.record},audioSource(){return this.record?this.record.url:""},playBtnIcon(){return this.isPlaying?"pause":"play"}},methods:{playback(){!this.audioSource||(this.isPlaying?this.player.pause():setTimeout(()=>{this.player.play()},0),this.isPlaying=!this.isPlaying)},_resetProgress(){this.isPlaying&&this.player.pause(),this.duration=n(0),this.playedTime=n(0),this.progress=0,this.isPlaying=!1},_onTimeUpdate(){this.playedTime=n(this.player.currentTime),this.progress=this.player.currentTime/this.player.duration*100},_onUpdateProgress(e){e&&(this.currentTime=e*this.duration)},_onChangeVolume(e){e&&(this.player.volume=e)}}},y={};var G=h(O,W,N,!1,X,null,null,null);function X(e){for(let s in y)this[s]=y[s]}var w=function(){return G.exports}(),q=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"recorder-container"},[t("div",{staticClass:"recorder-action"},[t("icon-button",{staticClass:"vue-recorder-action",attrs:{name:e.iconButtonType},on:{click:function(r){return e.toggleRecording()}}}),e.compact?e._e():t("icon-button",{staticClass:"vue-recorder-stop",attrs:{name:"stop"},on:{click:function(r){return e.stopRecording()}}})],1),t("div",{staticClass:"timing"},[e.attempts&&!e.compact?t("div",{staticClass:"time-attempt"},[e._v(" Attempts: "+e._s(e.attemptsLeft)+"/"+e._s(e.attempts)+" ")]):e._e(),t("div",{staticClass:"recording-time"},[e.countdown?t("span",[e._v(" "+e._s(e.countdownTitle))]):e._e(),t("span",{staticClass:"recorder-timer"},[e._v(e._s(e.recordedTime))])]),e.time&&!e.compact?t("div",{staticClass:"time-limit"},[e._v(" Record duration is limited: "+e._s(e.time)+"s ")]):e._e()]),!e.compact&&e.recordList.length>0?t("div",{staticClass:"vue-records"},e._l(e.recordList,function(r,i){return t("div",{key:r.id,staticClass:"vue-records__record",class:{"vue-records__record--selected":r.id===e.selected.id},on:{click:function(o){return e.choiceRecord(r)}}},[t("span",[e._v("Record "+e._s(i+1))]),t("div",{staticClass:"list-actions"},[r.id===e.selected.id&&e.showDownloadButton?t("icon-button",{attrs:{id:"download",name:"download"},on:{click:e.download}}):e._e(),r.id===e.selected.id&&e.showUploadButton?t("icon-button",{staticClass:"submit-button",attrs:{id:"upload",name:"upload"},on:{click:e.sendData}}):e._e(),r.id===e.selected.id?t("icon-button",{attrs:{name:"remove"},on:{click:function(o){return e.removeRecord(i)}}}):e._e()],1),t("div",{staticClass:"vue__text"},[e._v(e._s(r.duration))])])}),0):e._e(),t("player-widget",{attrs:{custom:e.customPlayer,record:e.selected}}),e.successMessage||e.errorMessage?t("div",{staticClass:"recorder-message"},[e.successMessage?t("span",{staticClass:"color-success"},[e._v(" "+e._s(e.successMessage)+" ")]):e._e(),e.errorMessage?t("span",{staticClass:"color-danger"},[e._v(" "+e._s(e.errorMessage)+" ")]):e._e()]):e._e()],1)},Y=[],ue="";const J="Failed to use microphone. Please refresh and try again and permit the use of a microphone.",K="Successfully recorded message!",Q="Successfully submitted audio message! Thank you!",b="Error submitting audio message! Please try again later.",ee={name:"RecorderWidget",components:{IconButton:p,PlayerWidget:w},props:{attempts:{type:Number},time:{type:Number},bitRate:{type:Number,default:128},sampleRate:{type:Number,default:44100},showDownloadButton:{type:Boolean,default:!0},showUploadButton:{type:Boolean,default:!0},beforeRecording:{type:Function},pauseRecording:{type:Function},afterRecording:{type:Function},selectRecord:{type:Function},backendEndpoint:{type:String},filename:{type:String,default:"audio"},compact:{type:Boolean,default:!1},customPlayer:{type:Boolean,default:!1},customUpload:{type:Function,default:null},countdown:{type:Boolean,default:!1},countdownTitle:{type:String,default:"Time remaining"}},data(){return{recording:!1,recorder:null,successMessage:null,errorMessage:null,recordList:[],selected:{}}},computed:{recordedTime(){var e,s,t;return this.time&&((e=this.recorder)==null?void 0:e.duration)>=this.time*60&&this.toggleRecording(),this.countdown?n(this.time-((s=this.recorder)==null?void 0:s.duration)):n((t=this.recorder)==null?void 0:t.duration)},attemptsLeft(){return this.attempts-this.recordList.length},iconButtonType(){return this.recording&&this.compact?"stop":this.recording?"record":"mic"}},beforeUnmount(){this.recording&&this.stopRecording()},methods:{toggleRecording(){this.recording=!this.recording,this.recording?this.initRecorder():this.stopRecording()},initRecorder(){this.recorder=new $({micFailed:this.micFailed,bitRate:this.bitRate,sampleRate:this.sampleRate}),this.recorder.start(),this.successMessage=null,this.errorMessage=null,this.service=new u(this.backendEndpoint)},stopRecording(){this.recording=!1,this.recorder.stop();const e=this.recorder.recordList();this.selected=e[0],this.selected&&this.selected.url?(this.recordList.push(this.selected),this.selected.url&&(this.successMessage=K),this.afterRecording&&this.afterRecording()):this.errorMessage=b},async sendData(){if(!this.selected)return;let e=null;this.customUpload?e=await this.customUpload(this.selected.blob):e=await this.service.postBackend(this.selected.blob),e?(this.errorMessage=null,this.successMessage=Q,this.successfulUpload&&this.successfulUpload()):(this.successMessage=null,this.errorMessage=b,this.failedUpload&&this.failedUpload())},micFailed(){this.recording=!1,this.errorMessage=J},removeRecord(e){this.recordList.splice(e,1),this.$set(this.selected,"url",null),this.$emit("remove-record")},choiceRecord(e){this.selected!==e&&(this.selected=e,this.selectRecord&&this.selectRecord(e))},download(){if(this.selected&&!this.selected.url)return;const e=this.selected.blob.type.split("/")[1],s=document.createElement("a");s.href=this.selected.url,s.download=`${this.filename}.${e}`,s.click()}}},x={};var te=h(ee,q,Y,!1,se,null,null,null);function se(e){for(let s in x)this[s]=x[s]}var re=function(){return te.exports}();d.PlayerWidget=w,d.RecorderWidget=re,Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
